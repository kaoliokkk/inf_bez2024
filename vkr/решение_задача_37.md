# Решение задачи оптимального управления 37

**Условие:**
- Функционал: `J = ∫₀^T (x''² - x'² - x²)dt → extr`
- Ограничение: `|x''| ≤ 1`
- Краевые условия: `x(0) = x(T) = 0`, `x'(0) = 0`
- Значения T: `{0.1; 1.0; 10.0; 20.0}`

## Решение:

### Шаг 1: Приведение к стандартной форме задачи оптимального управления

Введем новые переменные:
- `x₁ = x`
- `x₂ = x'`

Тогда:
- `x₁' = x₂`
- `x₂' = x'' = u` (управление)
- `|u| ≤ 1`

Функционал переписывается в виде:
```
J = ∫₀^T (u² - x₂² - x₁²)dt → extr
```

Краевые условия:
- `x₁(0) = 0`, `x₁(T) = 0`
- `x₂(0) = 0`

### Шаг 2: Функция Понтрягина

```
H = ψ₁x₂ + ψ₂u + u² - x₂² - x₁²
```

Группируя:
```
H = ψ₁x₂ - x₂² - x₁² + ψ₂u + u²
H = ψ₁x₂ - x₂² - x₁² + (ψ₂u + u²)
```

### Шаг 3: Сопряженные уравнения

```
ψ₁' = -∂H/∂x₁ = 2x₁
ψ₂' = -∂H/∂x₂ = -ψ₁ + 2x₂
```

### Шаг 4: Условие максимума

Максимизируем по u ∈ [-1, 1]:
```
max_{|u|≤1} H = max_{|u|≤1} [ψ₁x₂ - x₂² - x₁² + ψ₂u + u²]
```

Максимизируем функцию `φ(u) = ψ₂u + u²` при ограничении `|u| ≤ 1`.

Необходимое условие внутреннего экстремума: `φ'(u) = ψ₂ + 2u = 0`, откуда `u = -ψ₂/2`.

**Оптимальное управление:**

1. Если `-1 ≤ -ψ₂/2 ≤ 1`, т.е. `-2 ≤ ψ₂ ≤ 2`:
   ```
   u* = -ψ₂/2
   ```

2. Если `-ψ₂/2 > 1`, т.е. `ψ₂ < -2`:
   ```
   u* = 1
   ```

3. Если `-ψ₂/2 < -1`, т.е. `ψ₂ > 2`:
   ```
   u* = -1
   ```

Объединяя:
```
u* = {
  -1,      если ψ₂ > 2
  -ψ₂/2,   если -2 ≤ ψ₂ ≤ 2
   1,      если ψ₂ < -2
}
```

Или компактно:
```
u* = sat(-ψ₂/2, -1, 1) = clamp(-ψ₂/2, -1, 1)
```

### Шаг 5: Краевые условия для сопряженных переменных

Для задачи с фиксированными концами `x₁(T) = 0` и свободным концом `x₂(T)`:
- `ψ₁(T) = -∂G/∂x₁`, где `G = x₁(T)`, следовательно `ψ₁(T) = -1` или `0` в зависимости от формулировки
- `ψ₂(T)` свободно, следовательно `ψ₂(T) = 0` (условие трансверсальности)

Альтернативно, если оба конца фиксированы по x₁, то `ψ₁(T)` свободно.

Учитывая, что `x₁(T) = 0` фиксировано, а `x₂(T)` свободно:
```
ψ₂(T) = 0
```

### Шаг 6: Решение системы дифференциальных уравнений

Получаем систему:
```
x₁' = x₂
x₂' = u*
ψ₁' = 2x₁
ψ₂' = -ψ₁ + 2x₂
```

с краевыми условиями:
- `x₁(0) = 0`
- `x₂(0) = 0`
- `x₁(T) = 0`
- `ψ₂(T) = 0`

Эта система нелинейна из-за зависимости `u*` от `ψ₂`. Решение требует итерационного подхода или численных методов.

### Шаг 7: Анализ структуры управления

В зависимости от значения `ψ₂`:

**Случай 1:** Управление внутреннее, `u* = -ψ₂/2` на всем интервале

Подставляя `u* = -ψ₂/2`:
```
x₁' = x₂
x₂' = -ψ₂/2
ψ₁' = 2x₁
ψ₂' = -ψ₁ + 2x₂
```

Линейная система:
```
ẋ = Ax
```

где `x = [x₁, x₂, ψ₁, ψ₂]ᵀ` и матрица A определяется из уравнений.

**Случай 2:** Управление на границе `u* = ±1`

Если `u* = 1` или `u* = -1`, система упрощается:
```
x₁' = x₂
x₂' = ±1
ψ₁' = 2x₁
ψ₂' = -ψ₁ + 2x₂
```

### Шаг 8: Решение для различных T

Для малых T управление может быть внутренним, для больших T — на границе.

**При малых T (T = 0.1):**
Управление, вероятно, внутреннее.

**При больших T (T ≥ 1.0):**
Управление может переключаться между внутренним и граничными значениями.

### Ответ:

Оптимальное управление определяется из принципа максимума:
```
u*(t) = sat(-ψ₂(t)/2, -1, 1)
```

где `ψ₂(t)` находится из решения системы сопряженных уравнений и уравнений объекта с учетом краевых условий.

Для конкретных значений T решение находится численно или аналитически при упрощающих предположениях.
