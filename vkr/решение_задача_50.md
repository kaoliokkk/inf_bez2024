# Решение задачи оптимального управления 50 (с особым управлением)

**Условие:**
- Функционал: `J = ∫₀^T (x''² - x²)dt → extr`
- Ограничение: `|x'''| ≤ 1`
- Краевые условия: `x(0) = x(T) = 0`, `x'(0) = 1`
- Значения T: `{0.1; 1.0; 10.0; 20.0}`

## Решение:

### Шаг 1: Приведение к стандартной форме

Введем переменные состояния:
- `x₁ = x`
- `x₂ = x'`
- `x₃ = x''`

Тогда система:
- `x₁' = x₂`
- `x₂' = x₃`
- `x₃' = x''' = u` (управление)
- `|u| ≤ 1`

Функционал:
```
J = ∫₀^T (x₃² - x₁²)dt → extr
```

Краевые условия:
- `x₁(0) = 0`, `x₁(T) = 0`
- `x₂(0) = 1`

### Шаг 2: Функция Понтрягина

```
H = ψ₁x₂ + ψ₂x₃ + ψ₃u + x₃² - x₁²
```

Группируя:
```
H = -x₁² + ψ₁x₂ + x₃² + ψ₂x₃ + ψ₃u
```

### Шаг 3: Сопряженные уравнения

```
ψ₁' = -∂H/∂x₁ = 2x₁
ψ₂' = -∂H/∂x₂ = -ψ₁
ψ₃' = -∂H/∂x₃ = -ψ₂ - 2x₃
```

### Шаг 4: Условие максимума и функция переключения

Максимизируем по u ∈ [-1, 1]:
```
max_{|u|≤1} H = max_{|u|≤1} [-x₁² + ψ₁x₂ + x₃² + ψ₂x₃ + ψ₃u]
```

Функция переключения: `σ(t) = ψ₃(t)`

**Оптимальное управление (обычный режим):**

```
u* = {
  1,    если ψ₃ > 0
 -1,    если ψ₃ < 0
  ?,    если ψ₃ = 0 (особый режим)
}
```

### Шаг 5: Анализ особого управления первого порядка

Особый режим возникает, если `ψ₃(t) ≡ 0` на некотором интервале.

Если `ψ₃(t) = 0`, то:
```
ψ₃' = 0 = -ψ₂ - 2x₃
```

Следовательно:
```
ψ₂ = -2x₃    (1)
```

Дифференцируя (1):
```
ψ₂' = -2x₃' = -2u
```

С другой стороны:
```
ψ₂' = -ψ₁
```

Приравнивая:
```
-2u = -ψ₁
u = ψ₁/2    (2)
```

Дифференцируя `ψ₂' = -ψ₁`:
```
ψ₂'' = -ψ₁' = -2x₁
```

Также:
```
ψ₂'' = -2u' = -2u'
```

Следовательно:
```
-2u' = -2x₁
u' = x₁    (3)
```

Дифференцируя (2):
```
u' = ψ₁'/2 = (2x₁)/2 = x₁
```

Это совпадает с (3), что подтверждает возможность особого режима.

### Шаг 6: Уравнение для особого управления

В особом режиме должно выполняться:
```
u = ψ₁/2
```

Из `ψ₃ = 0` и `ψ₃' = 0`:
- `ψ₂ = -2x₃`
- `ψ₁ = 2u`

Дифференцируя `ψ₁ = 2u`:
```
ψ₁' = 2u' = 2x₁
```

Это согласуется с `ψ₁' = 2x₁`.

### Шаг 7: Система в особом режиме

В особом режиме:
```
x₁' = x₂
x₂' = x₃
x₃' = u = ψ₁/2
ψ₁' = 2x₁
ψ₂' = -ψ₁
```

Учитывая `ψ₂ = -2x₃`, получаем:
```
-2x₃' = -ψ₁
-2u = -ψ₁
u = ψ₁/2
```

Это самосогласованно.

### Шаг 8: Структура оптимального управления

Оптимальное управление может иметь структуру:
- Обычные режимы: `u = ±1`
- Особый режим: `u = ψ₁/2`, при условии `|u| ≤ 1`, т.е. `|ψ₁| ≤ 2`

Переключения происходят при `ψ₃ = 0`.

### Шаг 9: Краевые условия для сопряженных переменных

При `x₁(T) = 0` (фиксировано) и `x₂(T)`, `x₃(T)` свободных:
```
ψ₂(T) = 0 (условие трансверсальности)
ψ₃(T) = 0 (условие трансверсальности)
```

### Шаг 10: Решение для различных T

Для каждого значения T структура управления определяется из решения краевой задачи с возможными переключениями между обычными и особым режимами.

При малых T управление может быть на границе, при больших T возможно появление особого режима.

### Ответ:

Оптимальное управление определяется из принципа максимума:

**В обычном режиме:**
```
u*(t) = sign(ψ₃(t))
```

**В особом режиме (когда ψ₃(t) = 0):**
```
u*(t) = ψ₁(t)/2
```
при условии `|ψ₁| ≤ 2` (чтобы обеспечить `|u| ≤ 1`).

Сопряженные переменные находятся из системы:
```
ψ₁' = 2x₁
ψ₂' = -ψ₁
ψ₃' = -ψ₂ - 2x₃
```

с краевыми условиями `ψ₂(T) = 0`, `ψ₃(T) = 0`.
