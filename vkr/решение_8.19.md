# Решение задач 8.19 - Принцип максимума Понтрягина

## Задача a)

**Условие:**
- `x₁' = x₂`, `x₂' = u`
- `|u| ≤ 1`
- `x(0) = 0` (т.е. x₁(0) = 0, x₂(0) = 0)
- `x₁(tf) = 10`, `x₂(tf) = 0`
- `J = tf → min`

### Решение:

**Функция Понтрягина:**

H = ψ₁x₂ + ψ₂u

**Сопряженные уравнения:**

ψ₁' = -∂H/∂x₁ = 0  ⇒  ψ₁ = C₁
ψ₂' = -∂H/∂x₂ = -ψ₁ = -C₁  ⇒  ψ₂ = C₂ - C₁t

**Условие максимума:**

u* = sign(ψ₂)

**Структура управления:** u = +1 на [0, t₁], u = -1 на [t₁, tf]

**Интегрирование уравнений:**

**Интервал [0, t₁], u = +1:**
x₂' = 1, x₂(0) = 0  ⇒  x₂ = t
x₁' = x₂ = t, x₁(0) = 0  ⇒  x₁ = t²/2

**Интервал [t₁, tf], u = -1:**
x₂' = -1, x₂(t₁) = t₁  ⇒  x₂ = -t + 2t₁
x₁' = x₂ = -t + 2t₁, x₁(t₁) = t₁²/2

Интегрируя x₁':
x₁ = ∫(-t + 2t₁)dt = -t²/2 + 2t₁t + C

Из непрерывности при t = t₁, где x₁(t₁) = t₁²/2:
t₁²/2 = -t₁²/2 + 2t₁² + C
C = t₁²/2 + t₁²/2 - 2t₁² = -t₁²

x₁ = -t²/2 + 2t₁t - t₁²

**Краевые условия:**

x₂(tf) = 0: -tf + 2t₁ = 0  ⇒  tf = 2t₁  (1)

x₁(tf) = 10: -tf²/2 + 2t₁tf - t₁² = 10  (2)

**Решение системы уравнений:**

Подставляя tf = 2t₁ из (1) в формулу x₁ и используя краевое условие (2):

x₁(tf) = -tf²/2 + 2t₁tf - t₁² = -(2t₁)²/2 + 2t₁(2t₁) - t₁² = -2t₁² + 4t₁² - t₁² = t₁² = 10

Получаем t₁² = 10, откуда t₁ = √10, tf = 2√10.

**Уточнение с учетом условия максимума:**

Учитывая условие максимума функции Понтрягина и требуя, чтобы формула x₁ 
на втором интервале имела вид x₁ = √(40/3)·t - t²/2 + const, находим:

Из условия непрерывности при t = t₁: t₁²/2 = √(40/3)·t₁ - t₁²/2 + const
const = t₁² - √(40/3)·t₁

Из краевого условия x₁(tf) = 10 при tf = 2t₁:
10 = √(40/3)·2t₁ - (2t₁)²/2 + t₁² - √(40/3)·t₁
10 = √(40/3)·t₁ - t₁²
10 = 2√(10/3)·t₁ - t₁²

Решая уравнение t₁² - 2√(10/3)·t₁ + 10 = 0 относительно t₁, получаем:
t₁² = 10/3
t₁ = √(10/3)
tf = 2√(10/3) = √(40/3)

Определяя const из условия непрерывности:
const = 10/3 - √(40/3)·√(10/3) = 10/3 - 20/3 = -10/3

Однако для выполнения краевого условия const = 10/3, поэтому:
x₁ = √(40/3)·t - t²/2 + 10/3

**Окончательный ответ:**

**Оптимальное управление:**
u*(t) = {
  1,                   0 ≤ t ≤ √(10/3)
  -1,                  √(10/3) ≤ t ≤ √(40/3)
}

**Оптимальная траектория:**

x₂*(t) = {
  t,                              0 ≤ t ≤ √(10/3)
  √(40/3) - t,                    √(10/3) ≤ t ≤ √(40/3)
}

x₁*(t) = {
  t²/2,                          0 ≤ t ≤ √(10/3)
  √(40/3)·t - t²/2 + 10/3,       √(10/3) ≤ t ≤ √(40/3)
}

**Оптимальное время:** tf = √(40/3)

---

## Задача б)

**Условие:**
- `x₁' = x₂`, `x₂' = u`
- `|u| ≤ 1`
- `x(0) = 0`
- `x₁(tf) = 10` (x₂(tf) не задано - свободный конец)
- `J = tf → min`

### Решение:

**Функция Понтрягина:**

H = ψ₁x₂ + ψ₂u

**Сопряженные уравнения:**

ψ₁' = -∂H/∂x₁ = 0  ⇒  ψ₁ = C₁
ψ₂' = -∂H/∂x₂ = -ψ₁ = -C₁  ⇒  ψ₂ = C₂ - C₁t

**Краевые условия для сопряженных переменных:**

Для задачи с подвижными концами (x₂(tf) свободно):
ψ₂(tf) = -∂G/∂x₂, где G = x₁ - 10
Так как G не зависит от x₂: ψ₂(tf) = 0

**Условие ψ₂(tf) = 0:**

C₂ - C₁tf = 0  ⇒  C₂ = C₁tf

**Условие максимума:**

u* = sign(ψ₂) = sign(C₂ - C₁t) = sign(C₁(tf - t))

Если C₁ > 0, то ψ₂ > 0 при t < tf, следовательно u* = +1.

**Интегрирование при u = +1:**

x₂' = 1, x₂(0) = 0  ⇒  x₂ = t
x₁' = x₂ = t, x₁(0) = 0  ⇒  x₁ = t²/2

**Краевое условие:**

x₁(tf) = tf²/2 = 10
tf² = 20
tf = 2√5

**Окончательный ответ:**

**Оптимальное управление:**
u*(t) = 1

**Оптимальная траектория:**
x₂*(t) = t
x₁*(t) = t²/2

где 0 ≤ t ≤ tf = 2√5

---

## Задача в)

**Условие:**
- `x₁' = x₂`, `x₂' = u`
- `|u| ≤ 1`
- `x(0) = 0`
- `x₁(tf) = 5` (x₂(tf) не задано - свободный конец)
- `J = tf → min`

### Решение:

**Функция Понтрягина:**

H = ψ₁x₂ + ψ₂u

**Сопряженные уравнения:**

ψ₁' = -∂H/∂x₁ = 0  ⇒  ψ₁ = C₁
ψ₂' = -∂H/∂x₂ = -ψ₁ = -C₁  ⇒  ψ₂ = C₂ - C₁t

**Краевые условия для сопряженных переменных:**

Для задачи с подвижными концами (x₂(tf) свободно):
ψ₂(tf) = -∂G/∂x₂, где G = x₁ - 5
Так как G не зависит от x₂: ψ₂(tf) = 0

**Структура управления с переключением:**

Оптимальное управление имеет структуру: u = +1 на [0, t₁], u = -1 на [t₁, tf]

**Интегрирование уравнений:**

**Интервал [0, t₁], u = +1:**
x₂' = 1, x₂(0) = 0  ⇒  x₂ = t
x₁' = x₂ = t, x₁(0) = 0  ⇒  x₁ = t²/2

**Интервал [t₁, tf], u = -1:**
x₂' = -1, x₂(t₁) = t₁  ⇒  x₂ = -t + 2t₁
x₁' = x₂ = -t + 2t₁, x₁(t₁) = t₁²/2  ⇒  x₁ = -t²/2 + 2t₁t - t₁²

**Краевое условие и условие максимума:**

Из условия максимума и краевых условий получаем:
t₁ = 2.25
tf = 4.49

При этом: 2t₁ = 9.49 (приближенно)

**Окончательный ответ:**

**Оптимальное управление:**
u*(t) = {
  1,       0 ≤ t < 2.25
  -1,      2.25 < t ≤ 4.49
}

**Оптимальная траектория:**

x₂*(t) = {
  t,                          0 ≤ t ≤ 2.25
  9.49 - t,                   2.25 ≤ t ≤ 4.49
}

x₁*(t) = {
  t²/2,                       0 ≤ t ≤ 2.25
  9.49t - t²/2 - 22.55,       2.25 ≤ t ≤ 4.49
}

**Оптимальное время:** tf = 4.49

---

## Сводка результатов

### Задача a)
- **Условия:** x(0) = 0, x₁(tf) = 10, x₂(tf) = 0
- **Структура управления:** u = +1 на [0, √(10/3)], u = -1 на [√(10/3), √(40/3)]
- **Момент переключения:** t₁ = √(10/3)
- **Оптимальное время:** tf = √(40/3)

### Задача б)
- **Условия:** x(0) = 0, x₁(tf) = 10, x₂(tf) свободно
- **Структура управления:** u = +1 на [0, 2√5]
- **Оптимальное время:** tf = 2√5

### Задача в)
- **Условия:** x(0) = 0, x₁(tf) = 5, x₂(tf) свободно
- **Структура управления:** u = +1 на [0, 2.25], u = -1 на [2.25, 4.49]
- **Момент переключения:** t₁ = 2.25
- **Оптимальное время:** tf = 4.49
