# Решение задачи 8.20б - Метод динамического программирования

**Условие:**
- `x₁' = x₂`, `x₂' = u`
- `x(0) = x⁰`
- `J = ∫₀^∞ (u² + 4x₁² + 5x₂²)dt → min`

## Решение:

### Шаг 1: Уравнение Беллмана

Функция Беллмана не зависит от времени:
```
S = S(x₁, x₂)
```

Уравнение Беллмана:
```
min_u [u² + 4x₁² + 5x₂² + (∂S/∂x₁)·x₂ + (∂S/∂x₂)·u] = 0
```

### Шаг 2: Определение оптимального управления

Минимизируем по u:
```
L = u² + 4x₁² + 5x₂² + (∂S/∂x₁)·x₂ + (∂S/∂x₂)·u
```

Необходимое условие минимума: ∂L/∂u = 0
```
2u + ∂S/∂x₂ = 0
u* = -½(∂S/∂x₂)
```

### Шаг 3: Подстановка в уравнение Беллмана

Подставляя u*:
```
¼(∂S/∂x₂)² + 4x₁² + 5x₂² + (∂S/∂x₁)·x₂ - ½(∂S/∂x₂)² = 0
```

Упрощая:
```
-¼(∂S/∂x₂)² + 4x₁² + 5x₂² + (∂S/∂x₁)·x₂ = 0
```

Или:
```
(∂S/∂x₁)·x₂ + 4x₁² + 5x₂² - ¼(∂S/∂x₂)² = 0    (1)
```

### Шаг 4: Поиск функции Беллмана в виде квадратичной формы

Ищем S в виде:
```
S = a₁₁x₁² + 2a₁₂x₁x₂ + a₂₂x₂²
```

Тогда:
```
∂S/∂x₁ = 2a₁₁x₁ + 2a₁₂x₂
∂S/∂x₂ = 2a₁₂x₁ + 2a₂₂x₂
```

Подставляя в уравнение (1):
```
(2a₁₁x₁ + 2a₁₂x₂)·x₂ + 4x₁² + 5x₂² - ¼(2a₁₂x₁ + 2a₂₂x₂)² = 0
```

Раскрывая скобки:
```
2a₁₁x₁x₂ + 2a₁₂x₂² + 4x₁² + 5x₂² - ¼(4a₁₂²x₁² + 8a₁₂a₂₂x₁x₂ + 4a₂₂²x₂²) = 0
2a₁₁x₁x₂ + 2a₁₂x₂² + 4x₁² + 5x₂² - a₁₂²x₁² - 2a₁₂a₂₂x₁x₂ - a₂₂²x₂² = 0
```

Группируя по степеням:
```
(4 - a₁₂²)x₁² + (2a₁₁ - 2a₁₂a₂₂)x₁x₂ + (2a₁₂ + 5 - a₂₂²)x₂² = 0
```

Это равенство должно выполняться тождественно:
```
4 - a₁₂² = 0              (2)
2a₁₁ - 2a₁₂a₂₂ = 0        (3)
2a₁₂ + 5 - a₂₂² = 0       (4)
```

### Шаг 5: Решение системы для коэффициентов

Из (2): a₁₂² = 4, следовательно a₁₂ = ±2

Из (4): a₂₂² = 2a₁₂ + 5

При a₁₂ = 2: a₂₂² = 4 + 5 = 9, откуда a₂₂ = ±3
При a₁₂ = -2: a₂₂² = -4 + 5 = 1, откуда a₂₂ = ±1

Из (3): a₁₁ = a₁₂a₂₂

Вариант 1: a₁₂ = 2, a₂₂ = 3 → a₁₁ = 6
Вариант 2: a₁₂ = 2, a₂₂ = -3 → a₁₁ = -6
Вариант 3: a₁₂ = -2, a₂₂ = 1 → a₁₁ = -2
Вариант 4: a₁₂ = -2, a₂₂ = -1 → a₁₁ = 2

### Шаг 6: Выбор правильного решения

Функция Беллмана должна быть положительно определенной.

Для положительной определенности необходимо:
- a₁₁ > 0
- det(A) = a₁₁a₂₂ - a₁₂² > 0

Проверяем варианты:

Вариант 1: a₁₁ = 6, a₁₂ = 2, a₂₂ = 3
- a₁₁ = 6 > 0 ✓
- det = 6·3 - 4 = 14 > 0 ✓

Это правильное решение:
```
a₁₁ = 6
a₁₂ = 2
a₂₂ = 3
```

### Шаг 7: Оптимальное управление с обратной связью

Функция Беллмана:
```
S = 6x₁² + 4x₁x₂ + 3x₂²
```

Производная:
```
∂S/∂x₂ = 4x₁ + 6x₂
```

Оптимальное управление:
```
u* = -½(∂S/∂x₂) = -½(4x₁ + 6x₂) = -(2x₁ + 3x₂)
```

## Ответ:

**Оптимальный закон управления (с обратной связью):**
```
u*(x) = -(2x₁ + 3x₂)
```
