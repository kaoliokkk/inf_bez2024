# Решение задачи оптимального управления 38

**Условие:**
- Функционал: `J = ∫₀^T (x''² - x²)dt → extr`
- Ограничение: `|x''| ≤ 1`
- Краевые условия: `x(0) = x(T) = 0`, `x'(0) = 1`
- Значения T: `{0.1; 1.0; 10.0; 20.0}`

## Решение:

### Шаг 1: Приведение к стандартной форме задачи оптимального управления

Введем переменные:
- `x₁ = x`
- `x₂ = x'`

Тогда:
- `x₁' = x₂`
- `x₂' = x'' = u` (управление)
- `|u| ≤ 1`

Функционал:
```
J = ∫₀^T (u² - x₁²)dt → extr
```

Краевые условия:
- `x₁(0) = 0`, `x₁(T) = 0`
- `x₂(0) = 1`

### Шаг 2: Функция Понтрягина

```
H = ψ₁x₂ + ψ₂u + u² - x₁²
```

Группируя:
```
H = ψ₁x₂ - x₁² + ψ₂u + u²
```

### Шаг 3: Сопряженные уравнения

```
ψ₁' = -∂H/∂x₁ = 2x₁
ψ₂' = -∂H/∂x₂ = -ψ₁
```

### Шаг 4: Условие максимума

Максимизируем по u ∈ [-1, 1]:
```
max_{|u|≤1} H = max_{|u|≤1} [ψ₁x₂ - x₁² + ψ₂u + u²]
```

Максимизируем `φ(u) = ψ₂u + u²` при `|u| ≤ 1`.

Необходимое условие: `φ'(u) = ψ₂ + 2u = 0`, откуда `u = -ψ₂/2`.

**Оптимальное управление:**

1. Если `-1 ≤ -ψ₂/2 ≤ 1`, т.е. `-2 ≤ ψ₂ ≤ 2`:
   ```
   u* = -ψ₂/2
   ```

2. Если `-ψ₂/2 > 1`, т.е. `ψ₂ < -2`:
   ```
   u* = 1
   ```

3. Если `-ψ₂/2 < -1`, т.е. `ψ₂ > 2`:
   ```
   u* = -1
   ```

Компактно:
```
u* = sat(-ψ₂/2, -1, 1) = clamp(-ψ₂/2, -1, 1)
```

### Шаг 5: Краевые условия для сопряженных переменных

При `x₁(T) = 0` (фиксировано) и `x₂(T)` свободно:
```
ψ₂(T) = 0
```

### Шаг 6: Решение системы дифференциальных уравнений

Получаем систему:
```
x₁' = x₂
x₂' = u*
ψ₁' = 2x₁
ψ₂' = -ψ₁
```

с краевыми условиями:
- `x₁(0) = 0`
- `x₂(0) = 1`
- `x₁(T) = 0`
- `ψ₂(T) = 0`

### Шаг 7: Анализ структуры управления

**Случай внутреннего управления:** `u* = -ψ₂/2`

Подставляя в систему:
```
x₁' = x₂
x₂' = -ψ₂/2
ψ₁' = 2x₁
ψ₂' = -ψ₁
```

Дифференцируя `ψ₂'`:
```
ψ₂'' = -ψ₁' = -2x₁
```

Из `x₂' = -ψ₂/2`:
```
x₂'' = -ψ₂'/2 = -(-ψ₁)/2 = ψ₁/2
```

Также из `x₁' = x₂`:
```
x₁'' = x₂' = -ψ₂/2
```

Комбинируя:
```
ψ₂ = -2x₁''
```

Тогда:
```
ψ₂'' = -2x₁^(4)
```

С другой стороны:
```
ψ₂'' = -2x₁
```

Получаем:
```
x₁^(4) = x₁
```

**Характеристическое уравнение:** `r⁴ - 1 = 0`

Корни: `r = ±1, ±i`

Общее решение:
```
x₁(t) = C₁e^t + C₂e^(-t) + C₃cos(t) + C₄sin(t)
```

**Случай граничного управления:** `u* = ±1`

Если `u* = 1` или `u* = -1`, то:
```
x₁' = x₂
x₂' = ±1
ψ₁' = 2x₁
ψ₂' = -ψ₁
```

### Шаг 8: Использование краевых условий

**При внутреннем управлении:**

Из `x₁(0) = 0`:
```
C₁ + C₂ + C₃ = 0    (1)
```

Из `x₁(T) = 0`:
```
C₁e^T + C₂e^(-T) + C₃cos(T) + C₄sin(T) = 0    (2)
```

Из `x₂(0) = 1`:
```
x₂(0) = x₁'(0) = C₁ - C₂ - C₃sin(0) + C₄cos(0) = C₁ - C₂ + C₄ = 1    (3)
```

Из условия `ψ₂(T) = 0` и связи `ψ₂ = -2x₁''`:
```
x₁''(T) = 0
```

Вычисляя вторую производную:
```
x₁''(t) = C₁e^t + C₂e^(-t) - C₃cos(t) - C₄sin(t)
```

При t = T:
```
C₁e^T + C₂e^(-T) - C₃cos(T) - C₄sin(T) = 0    (4)
```

Также из условия максимума должно выполняться `|ψ₂(T)| ≤ 2`, т.е. `|x₁''(T)| ≤ 1`.

### Шаг 9: Решение для различных T

Для каждого T система (1)-(4) решается с учетом условия `|x₁''(T)| ≤ 1`.

### Ответ:

Оптимальное управление:
```
u*(t) = sat(-ψ₂(t)/2, -1, 1)
```

где `ψ₂(t)` находится из решения системы сопряженных уравнений. Для внутреннего управления решение имеет вид:
```
x₁(t) = C₁e^t + C₂e^(-t) + C₃cos(t) + C₄sin(t)
```

с коэффициентами, определяемыми из краевых условий для каждого T.
